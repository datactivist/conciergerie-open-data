version: "2.0"
stories:

- story: initial msg yes
  steps:
  - intent: get_started
  - action: utter_initial_message
  - intent: affirm
  - action: action_reset_all_slots
  - action: search_form
  - active_loop: search_form

- story: initial msg no
  steps:
  - intent: get_started
  - action: utter_initial_message
  - intent: deny
  - action: utter_goodbye

- story: ask/skills answer yes
  steps:
  - action: utter_faq/ask_skills
  - intent: affirm
  - action: action_reset_all_slots
  - action: search_form
  - active_loop: search_form

- story: ask/skills answer no
  steps:
  - action: utter_faq/ask_skills
  - intent: deny
  - action: utter_goodbye

- story: search form
  steps:
  - intent: affirm
  - action: action_reset_all_slots
  - action: search_form
  - active_loop: search_form
  - active_loop: null
  - action: utter_submit_search_form
  - action: action_send_search_information_to_API
  - action: action_send_keywords_feedback_to_expansion_API
  - action: action_search_database
  - slot_was_set:
    - results: null
  - action: utter_feedback_proposition
  - checkpoint: check_feedback_proposition_response

- story: handle user affirm feedback proposition and need something else
  steps:
  - checkpoint: check_feedback_proposition_response
  - intent: affirm
  - action: utter_thanks_you
  - action: feedback_results_form
  - active_loop: feedback_results_form
  - intent: feedback
  - action: feedback_results_form
  - active_loop: null
  - action: action_recap_feedback_to_user
  - action: action_send_results_feedback_to_reranking_API
  - action: action_reset_all_slots
  - action: utter_submit_feedback_form
  - intent: affirm
  - action: action_reset_all_slots
  - action: search_form
  - active_loop: search_form


- story: handle user affirm feedback proposition but doesn't need something else
  steps:
  - checkpoint: check_feedback_proposition_response
  - intent: affirm
  - action: utter_thanks_you
  - action: feedback_results_form
  - active_loop: feedback_results_form
  - intent: feedback
  - action: feedback_results_form
  - active_loop: null
  - action: action_recap_feedback_to_user
  - action: action_send_results_feedback_to_reranking_API
  - action: action_reset_all_slots
  - action: utter_submit_feedback_form
  - intent: deny
  - action: utter_goodbye

- story: handle user deny feedback proposition and doesn't need something else
  steps:
  - checkpoint: check_feedback_proposition_response
  - intent: deny
  - action: action_reset_all_slots
  - action: utter_no_problem_anything_else
  - intent: deny
  - action: utter_goodbye

- story: handle user deny feedback proposition but need something else
  steps:
  - checkpoint: check_feedback_proposition_response
  - intent: deny
  - action: action_reset_all_slots
  - action: utter_no_problem_anything_else
  - intent: affirm
  - action: action_reset_all_slots
  - action: search_form
  - active_loop: search_form